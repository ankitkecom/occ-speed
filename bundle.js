/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/main/checkout.ts":
/*!******************************!*\
  !*** ./src/main/checkout.ts ***!
  \******************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.initBuyItNow = exports.initCheckout = exports.initCashfreeCheckout = exports.revertCart = void 0;\nconst button_1 = __webpack_require__(/*! ./constants/button */ \"./src/main/constants/button.ts\");\nconst utm_1 = __webpack_require__(/*! ./constants/utm */ \"./src/main/constants/utm.ts\");\nconst logger_1 = __webpack_require__(/*! ./logger */ \"./src/main/logger/index.ts\");\nconst utils_1 = __webpack_require__(/*! ./utils */ \"./src/main/utils/index.ts\");\nconst storage_1 = __importDefault(__webpack_require__(/*! ./utils/storage */ \"./src/main/utils/storage.ts\"));\nconst fetchShopifyCart = () => __awaiter(void 0, void 0, void 0, function* () {\n    var _a;\n    try {\n        const response = yield fetch(`${window.location.origin}/cart.js`);\n        const data = yield response.json();\n        if ((_a = data === null || data === void 0 ? void 0 : data.items) === null || _a === void 0 ? void 0 : _a.length) {\n            return data;\n        }\n    }\n    catch (err) {\n        console.error(err);\n        throw err;\n    }\n});\nconst getPaymentSessionId = (cart) => __awaiter(void 0, void 0, void 0, function* () {\n    var _a, _b;\n    try {\n        const storage = new storage_1.default();\n        const utmParameters = storage.get(utm_1.UTM_SESSION_STORAGE_KEY);\n        const reqObject = {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify(Object.assign({ shop: (_a = window.Shopify) === null || _a === void 0 ? void 0 : _a.shop, cart: cart, return_url: window.location.href }, (utmParameters &&\n                ((_b = Object.keys(utmParameters)) === null || _b === void 0 ? void 0 : _b.length) && {\n                utm: Object.assign(Object.assign(Object.assign({}, utmParameters), { event_source_url: window.location.href }), (document.referrer && {\n                    referrer: document.referrer,\n                })),\n            }))),\n        };\n        const createOrderUrl = \"https://payments-test.cashfree.com/pgbillpayuiapi/integration/shopify/checkout/v2/createOrder\";\n        if (!createOrderUrl) {\n            throw new Error(\"CASHFREE_CREATE_ORDER_URL is not defined\");\n        }\n        const response = yield fetch(createOrderUrl, reqObject);\n        const data = yield response.json();\n        if (data === null || data === void 0 ? void 0 : data.payment_session_id) {\n            return data.payment_session_id;\n        }\n        throw new Error(\"Payment session id not found in response\");\n    }\n    catch (err) {\n        const error = err;\n        (0, logger_1.logger)(\"error\", `Error in getting payment session id :: ${error === null || error === void 0 ? void 0 : error.message}`);\n        throw error;\n    }\n});\nconst revertCart = () => __awaiter(void 0, void 0, void 0, function* () {\n    var _a, _b;\n    try {\n        const cartString = localStorage.getItem(\"cf-old-cart\");\n        if (cartString) {\n            let cart = JSON.parse(cartString);\n            if ((_a = cart === null || cart === void 0 ? void 0 : cart.items) === null || _a === void 0 ? void 0 : _a.length) {\n                yield fetch(`${window.location.origin}/cart/clear.js`, {\n                    method: \"POST\",\n                });\n                let data = {\n                    items: cart.items,\n                };\n                if ((_b = data.items) === null || _b === void 0 ? void 0 : _b.length) {\n                    fetch(`${window.location.origin}/cart/add.js`, {\n                        method: \"POST\",\n                        body: JSON.stringify(data),\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                        },\n                    });\n                }\n            }\n        }\n    }\n    catch (err) {\n        console.log(err);\n    }\n});\nexports.revertCart = revertCart;\nconst revertLoader = (button) => {\n    try {\n        if (!button)\n            return;\n        button.innerHTML = button.dataset.originalText || \"\";\n        button.classList.remove(\"cf-loader\");\n        if (button instanceof HTMLButtonElement ||\n            button instanceof HTMLInputElement) {\n            button.disabled = false;\n        }\n    }\n    catch (err) {\n        console.error(`Error in revertLoader :: ${err === null || err === void 0 ? void 0 : err.message}`);\n    }\n};\nconst initCashfreeCheckout = (paymentSessionId_1, ...args_1) => __awaiter(void 0, [paymentSessionId_1, ...args_1], void 0, function* (paymentSessionId, shouldRevertCart = false) {\n    try {\n        if (!paymentSessionId) {\n            (0, logger_1.logger)(\"error\", `Payment session id not found`);\n            return;\n        }\n        // * Load CF SDK, if Cashfree SDK is not loaded already\n        yield (0, utils_1.loadScript)(button_1.CF_SDK_URL);\n        if (window.Cashfree &&\n            typeof window.Cashfree === \"function\") {\n            // * Reverting the loader\n            const checkoutBtn = document.querySelector(\".cf-loader\");\n            // * Reverting loader after 1s\n            setTimeout(() => {\n                revertLoader(checkoutBtn);\n            }, 1000);\n            const cashfree = window.Cashfree({\n                mode: \"sandbox\",\n            });\n            let checkoutOptions = {\n                paymentSessionId,\n                redirectTarget: \"_modal\",\n                platformName: \"sh\",\n            };\n            cashfree.checkout(checkoutOptions).then((result) => {\n                if (result.error) {\n                    (0, logger_1.logger)(\"info\", `Payment error :: ${result.error}`);\n                }\n            });\n        }\n    }\n    catch (err) {\n        (0, logger_1.logger)(\"error\", `Error in initiating Cashfree checkout :: ${err}`);\n        (0, utils_1.redirectToShopify)(shouldRevertCart);\n    }\n});\nexports.initCashfreeCheckout = initCashfreeCheckout;\nconst initCheckout = (checkoutBtn_1, ...args_1) => __awaiter(void 0, [checkoutBtn_1, ...args_1], void 0, function* (checkoutBtn, shouldRevertCart = false, formElement = null) {\n    try {\n        console.log(\"heyyy\", checkoutBtn, \"abcdabcd\");\n        // * Checking if button is a valid HTML element\n        if (!checkoutBtn)\n            return;\n        if (checkoutBtn instanceof HTMLElement) {\n            // * Creating an iframe element\n            const iframe = document.createElement(\"iframe\");\n            iframe.width = \"768\";\n            iframe.height = \"500\";\n            iframe.style.border = \"none\";\n            iframe.srcdoc = \"<p>Placeholder</p>\";\n            // * Styling the iframe as a modal\n            iframe.style.position = \"fixed\";\n            iframe.style.top = \"50%\";\n            iframe.style.left = \"50%\";\n            iframe.style.transform = \"translate(-50%, -50%)\";\n            iframe.style.zIndex = \"1000\";\n            iframe.style.backgroundColor = \"white\";\n            iframe.style.boxShadow = \"0 4px 8px rgba(0, 0, 0, 0.2)\";\n            // * Adding a backdrop for the modal\n            const backdrop = document.createElement(\"div\");\n            backdrop.style.position = \"fixed\";\n            backdrop.style.top = \"0\";\n            backdrop.style.left = \"0\";\n            backdrop.style.width = \"100%\";\n            backdrop.style.height = \"100%\";\n            backdrop.style.backgroundColor = \"rgba(0, 0, 0, 0.5)\";\n            backdrop.style.zIndex = \"999\";\n            // * Appending the iframe and backdrop to the body\n            document.body.appendChild(backdrop);\n            document.body.appendChild(iframe);\n            // * Adding a click event to the backdrop to close the modal\n            backdrop.addEventListener(\"click\", () => {\n                document.body.removeChild(iframe);\n                document.body.removeChild(backdrop);\n            });\n            console.log(\"helllyyyy\");\n            // * Fetching cart  data from Shopify\n            const cartData = yield fetchShopifyCart();\n            // * Calling the CF's api to create a checkout\n            const paymentSessionId = yield getPaymentSessionId(cartData);\n            // * Initiating the checkout process\n            (0, exports.initCashfreeCheckout)(paymentSessionId, shouldRevertCart);\n        }\n        // * If shouldRevertCart is true, then revert the cart to the previous state\n        if (shouldRevertCart) {\n            yield (0, exports.revertCart)();\n        }\n    }\n    catch (err) {\n        console.error(err);\n        (0, utils_1.redirectToShopify)(shouldRevertCart, formElement);\n    }\n});\nexports.initCheckout = initCheckout;\nconst initBuyItNow = (checkoutBtn) => __awaiter(void 0, void 0, void 0, function* () {\n    var _a, _b, _c, _d, _e, _f, _g;\n    let productForm = checkoutBtn.closest(\"form\");\n    try {\n        let formObject = {};\n        // * Returning if checkout button is disabled, i.e, product is out of stock\n        let addToCartBtn = checkoutBtn === null || checkoutBtn === void 0 ? void 0 : checkoutBtn.closest(\"button\");\n        if (addToCartBtn &&\n            ((_b = (_a = addToCartBtn.textContent) === null || _a === void 0 ? void 0 : _a.trim()) === null || _b === void 0 ? void 0 : _b.toLowerCase()) === \"add to cart\" &&\n            addToCartBtn.disabled) {\n            return;\n        }\n        if (productForm) {\n            let formEntries = new FormData(productForm).entries();\n            if (formEntries) {\n                for (let entry of formEntries) {\n                    formObject[entry[0]] = entry[1];\n                }\n            }\n            if (!formObject.id) {\n                (0, logger_1.logger)(\"error\", `Id not found in form object`);\n                return;\n            }\n        }\n        const response = yield fetch(`${window.location.origin}/cart.js`, {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n        });\n        const cart = yield response.json();\n        localStorage.setItem(\"cf-old-cart\", JSON.stringify(cart));\n        if ((_c = cart === null || cart === void 0 ? void 0 : cart.items) === null || _c === void 0 ? void 0 : _c.length) {\n            yield fetch(`${window.location.origin}/cart/clear.js`, {\n                method: \"POST\",\n            });\n        }\n        const convertedFormObject = (0, utils_1.convertToObject)(formObject);\n        if (convertedFormObject) {\n            formObject = convertedFormObject;\n        }\n        let quantityInput = ((_d = productForm === null || productForm === void 0 ? void 0 : productForm.querySelector(\"input.quantity__input\")) === null || _d === void 0 ? void 0 : _d.value) ||\n            ((_e = productForm === null || productForm === void 0 ? void 0 : productForm.querySelector(\"input[name='quantity']\")) === null || _e === void 0 ? void 0 : _e.value) ||\n            ((_f = checkoutBtn.closest(\"input.quantity__input\")) === null || _f === void 0 ? void 0 : _f.value) ||\n            ((_g = checkoutBtn.closest(\"input[name='quantity']\")) === null || _g === void 0 ? void 0 : _g.value) ||\n            \"1\";\n        if (!formObject.quantity) {\n            formObject.quantity = parseInt(quantityInput);\n        }\n        yield fetch(`${window.location.origin}/cart/add.js`, {\n            method: \"POST\",\n            body: JSON.stringify(formObject),\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n        });\n        // * Initiating the checkout process\n        (0, exports.initCheckout)(checkoutBtn, true, productForm);\n    }\n    catch (err) {\n        console.error(err);\n        (0, utils_1.redirectToShopify)(true, productForm);\n    }\n});\nexports.initBuyItNow = initBuyItNow;\n\n\n//# sourceURL=webpack:///./src/main/checkout.ts?");

/***/ }),

/***/ "./src/main/constants/button.ts":
/*!**************************************!*\
  !*** ./src/main/constants/button.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.CF_SDK_URL = exports.CF_BUTTON_UNIQUE_CLASS = void 0;\nexports.CF_BUTTON_UNIQUE_CLASS = \"cf-occ-btn\";\nexports.CF_SDK_URL = \"https://sdk.cashfree.com/js/v3/cashfree.js\";\n\n\n//# sourceURL=webpack:///./src/main/constants/button.ts?");

/***/ }),

/***/ "./src/main/constants/utm.ts":
/*!***********************************!*\
  !*** ./src/main/constants/utm.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.UTM_SESSION_STORAGE_KEY = exports.CHANGE_CAPTURE_UTM_PARAMS = exports.OCC_ACCEPTED_UTM_PARAMS = void 0;\nexports.OCC_ACCEPTED_UTM_PARAMS = [\n    \"utm_source\",\n    \"utm_campaign\",\n    \"utm_medium\",\n    \"utm_content\",\n    \"utm_term\",\n    \"fbclid\",\n    \"gclid\",\n];\nexports.CHANGE_CAPTURE_UTM_PARAMS = [\n    \"utm_source\",\n    \"utm_campaign\",\n    \"utm_medium\",\n];\nexports.UTM_SESSION_STORAGE_KEY = \"cashfree-occ-utm\";\n\n\n//# sourceURL=webpack:///./src/main/constants/utm.ts?");

/***/ }),

/***/ "./src/main/eventListeners.ts":
/*!************************************!*\
  !*** ./src/main/eventListeners.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.initEventListeners = void 0;\nconst button_1 = __webpack_require__(/*! ./constants/button */ \"./src/main/constants/button.ts\");\nconst checkout_1 = __webpack_require__(/*! ./checkout */ \"./src/main/checkout.ts\");\nconst logger_1 = __webpack_require__(/*! ./logger */ \"./src/main/logger/index.ts\");\nconst utm_1 = __webpack_require__(/*! ./constants/utm */ \"./src/main/constants/utm.ts\");\nconst storage_1 = __importDefault(__webpack_require__(/*! ./utils/storage */ \"./src/main/utils/storage.ts\"));\nconst utils_1 = __webpack_require__(/*! ./utils */ \"./src/main/utils/index.ts\");\nconst clearCartAndRedirect = () => {\n    try {\n        // * Listening to the message on window\n        window.addEventListener(\"message\", (event) => {\n            var _a, _b, _c, _d, _e, _f, _g;\n            try {\n                const allowedOrigin = \"cashfree.com\";\n                if (event.origin.includes(allowedOrigin)) {\n                    if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.clearShopifyCart) === true ||\n                        ((_b = event.data) === null || _b === void 0 ? void 0 : _b.paymentStatus) === \"SUCCESS\") {\n                        // * Clearing the cart\n                        fetch(`${window.location.origin}/cart/clear.js`, {\n                            method: \"POST\",\n                        });\n                    }\n                    if ((_d = (_c = event.data) === null || _c === void 0 ? void 0 : _c.event_data) === null || _d === void 0 ? void 0 : _d.thankYouPageUrl) {\n                        let cleanedString = (_g = (_f = (_e = event.data) === null || _e === void 0 ? void 0 : _e.event_data) === null || _f === void 0 ? void 0 : _f.thankYouPageUrl) === null || _g === void 0 ? void 0 : _g.replace(/\\[|\\]/g, \"\");\n                        window.location.href = cleanedString;\n                    }\n                }\n            }\n            catch (err) {\n                (0, logger_1.logger)(\"error\", `Error in clearing cart :: ${err === null || err === void 0 ? void 0 : err.message}`);\n            }\n        });\n    }\n    catch (err) {\n        (0, logger_1.logger)(\"error\", `Error in clearing cart :: ${err === null || err === void 0 ? void 0 : err.message}`);\n    }\n};\nconst setUtmParams = () => {\n    try {\n        const utmParameters = getUtmParameters();\n        const storage = new storage_1.default();\n        updateStorageWithUtmParams(storage, utmParameters);\n    }\n    catch (err) {\n        (0, logger_1.logger)(\"error\", `Error in setting UTM params :: ${err === null || err === void 0 ? void 0 : err.message}`);\n    }\n};\nconst getUtmParameters = () => {\n    let self = window.location.href;\n    let querystring = self.split(\"?\");\n    let utmParameters = {};\n    if (querystring.length > 1) {\n        let pairs = querystring[1].split(\"&\");\n        for (let i in pairs) {\n            // * Checking if pairs[i] is a string\n            if (typeof pairs[i] === \"string\" &&\n                typeof pairs[i].split === \"function\") {\n                let keyval = pairs[i].split(\"=\");\n                if (utm_1.OCC_ACCEPTED_UTM_PARAMS.includes(keyval[0])) {\n                    let value = decodeURIComponent(keyval[1]);\n                    if (value === null || value === void 0 ? void 0 : value.length) {\n                        utmParameters[keyval[0]] = value;\n                    }\n                }\n            }\n        }\n    }\n    const fbp = (0, utils_1.getCookie)(\"_fbp\");\n    const fbc = (0, utils_1.getCookie)(\"_fbc\");\n    const ga_client_id = (0, utils_1.getCookie)(\"_ga\");\n    utmParameters = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, utmParameters), (fbp ? { fbp } : {})), (fbc ? { fbc } : {})), (ga_client_id ? { ga_client_id } : {})), { fb_event_id: (0, utils_1.generateFbEventId)() });\n    return utmParameters;\n};\nconst updateStorageWithUtmParams = (storage, utmParameters) => {\n    let storedParams = storage.get(utm_1.UTM_SESSION_STORAGE_KEY);\n    if (!storedParams) {\n        storage.set(utm_1.UTM_SESSION_STORAGE_KEY, utmParameters);\n    }\n    else {\n        // * If anyone of the changeCaptureUtmParams is present in utmParameters, override the storedParamsObj else not\n        let shouldUpdate = utm_1.CHANGE_CAPTURE_UTM_PARAMS.some((key) => Object.keys(utmParameters).includes(key));\n        if (shouldUpdate) {\n            storage.set(utm_1.UTM_SESSION_STORAGE_KEY, utmParameters);\n        }\n    }\n};\nconst initEventListeners = () => {\n    try {\n        // * Add payment success event listener\n        clearCartAndRedirect();\n        // * Adding click event listener to the document\n        document.addEventListener(\"click\", (e) => {\n            var _a, _b;\n            try {\n                let clickTarget = e.target;\n                if (typeof (clickTarget === null || clickTarget === void 0 ? void 0 : clickTarget.closest) === \"function\") {\n                    clickTarget = clickTarget.closest(\".\" + button_1.CF_BUTTON_UNIQUE_CLASS);\n                }\n                if (((_a = clickTarget === null || clickTarget === void 0 ? void 0 : clickTarget.classList) === null || _a === void 0 ? void 0 : _a.contains(button_1.CF_BUTTON_UNIQUE_CLASS)) &&\n                    ((_b = clickTarget.dataset) === null || _b === void 0 ? void 0 : _b.function)) {\n                    let checkoutBtn = clickTarget;\n                    // * Stopping the event propagation\n                    e.preventDefault();\n                    e.stopPropagation();\n                    e.stopImmediatePropagation();\n                    // * Initializing the checkout process\n                    switch (checkoutBtn.dataset.function) {\n                        case \"initCheckout\":\n                            (0, checkout_1.initCheckout)(checkoutBtn);\n                            break;\n                        case \"initBuyNow\":\n                            (0, checkout_1.initBuyItNow)(checkoutBtn);\n                            break;\n                    }\n                }\n            }\n            catch (err) {\n                window.triggerSentry(`Error in click event listener :: ${err === null || err === void 0 ? void 0 : err.message}`);\n            }\n        }, true);\n        // * Setting UTM params at window load\n        setUtmParams();\n    }\n    catch (err) {\n        console.error(err);\n    }\n};\nexports.initEventListeners = initEventListeners;\n\n\n//# sourceURL=webpack:///./src/main/eventListeners.ts?");

/***/ }),

/***/ "./src/main/index.ts":
/*!***************************!*\
  !*** ./src/main/index.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst checkout_1 = __webpack_require__(/*! ./checkout */ \"./src/main/checkout.ts\");\nconst eventListeners_1 = __webpack_require__(/*! ./eventListeners */ \"./src/main/eventListeners.ts\");\nconst logger_1 = __webpack_require__(/*! ./logger */ \"./src/main/logger/index.ts\");\nconst initiateThemeSetup = () => __awaiter(void 0, void 0, void 0, function* () {\n    try {\n        // * Initiating event listeners\n        (0, eventListeners_1.initEventListeners)();\n        console.log(\"helloooo\");\n        window.CashfreeOcc = {\n            initBuyItNow: checkout_1.initBuyItNow,\n            initCheckout: checkout_1.initCheckout,\n        };\n    }\n    catch (err) {\n        (0, logger_1.logger)(\"error\", `Error in initiating theme setup :: ${err}`);\n    }\n});\ninitiateThemeSetup();\n\n\n//# sourceURL=webpack:///./src/main/index.ts?");

/***/ }),

/***/ "./src/main/logger/index.ts":
/*!**********************************!*\
  !*** ./src/main/logger/index.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n//  * Create a logger function that logs the message and type of log\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.logger = void 0;\nconst logger = (type, message) => {\n    console[type](`Cashfree Checkout SDK: ${message}`);\n};\nexports.logger = logger;\n\n\n//# sourceURL=webpack:///./src/main/logger/index.ts?");

/***/ }),

/***/ "./src/main/utils/index.ts":
/*!*********************************!*\
  !*** ./src/main/utils/index.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.generateFbEventId = exports.getCookie = exports.loadScript = exports.convertToObject = exports.redirectToShopify = void 0;\nconst logger_1 = __webpack_require__(/*! ../logger */ \"./src/main/logger/index.ts\");\nconst redirectToShopify = (checkoutInitiatedByBuyNow = false, formElement = null) => {\n    try {\n        if (!checkoutInitiatedByBuyNow) {\n            window.location.href = \"/cart/checkout\";\n        }\n        else {\n            let variantId;\n            let quantity = 1;\n            if (formElement && formElement instanceof HTMLFormElement) {\n                const formEntries = new FormData(formElement).entries();\n                const formObject = {};\n                if (formEntries) {\n                    for (const [key, value] of formEntries) {\n                        formObject[key] = value;\n                    }\n                }\n                if (formObject.id) {\n                    variantId = formObject.id.toString();\n                }\n                if (formObject.quantity) {\n                    const quantityValue = formObject.quantity.toString();\n                    quantity = parseInt(quantityValue, 10) || 1;\n                }\n                if (variantId && quantity) {\n                    window.location.href = `/cart/${variantId}:${quantity}`;\n                }\n                else {\n                    window.location.href = `/cart`;\n                }\n            }\n            else {\n                window.location.href = `/cart`;\n            }\n        }\n    }\n    catch (err) {\n        const error = err;\n        (0, logger_1.logger)(\"error\", `Error in redirecting to Shopify :: ${error === null || error === void 0 ? void 0 : error.message}`);\n        window.location.href = \"/cart/checkout\";\n    }\n};\nexports.redirectToShopify = redirectToShopify;\nconst convertToObject = (obj) => {\n    try {\n        let newObj = {};\n        for (let key in obj) {\n            if (key.includes(\"[\") && key.includes(\"]\")) {\n                let keyName = key.split(\"[\")[0];\n                let keyValue = key.split(\"[\")[1].split(\"]\")[0];\n                if (keyName in newObj) {\n                    newObj[keyName][keyValue] = obj[key];\n                }\n                else {\n                    newObj[keyName] = {};\n                    newObj[keyName][keyValue] = obj[key];\n                }\n            }\n            else {\n                newObj[key] = obj[key];\n            }\n        }\n        return newObj;\n    }\n    catch (err) {\n        (0, logger_1.logger)(\"error\", `Error in converting object :: ${err}`);\n    }\n};\nexports.convertToObject = convertToObject;\nconst loadScript = (url) => {\n    // Retrying for 3 times, if fails\n    let retryCount = 0;\n    return new Promise((resolve, reject) => {\n        const loadScriptInternal = () => {\n            const script = document.createElement(\"script\");\n            script.src = url;\n            script.async = true;\n            script.onload = () => {\n                resolve(true);\n            };\n            script.onerror = () => {\n                retryCount++;\n                if (retryCount < 3) {\n                    loadScriptInternal();\n                }\n                else {\n                    reject(false);\n                }\n            };\n            document.head.appendChild(script);\n        };\n        loadScriptInternal();\n    });\n};\nexports.loadScript = loadScript;\n// * This function is used to get the value of a cookie\nconst getCookie = (name) => {\n    const value = `; ${document.cookie}`;\n    const parts = value.split(`; ${name}=`);\n    if (parts.length >= 2) {\n        const part = parts.pop();\n        if (part)\n            return part.split(\";\").shift();\n    }\n};\nexports.getCookie = getCookie;\nconst generateFbEventId = () => {\n    // Get current timestamp in milliseconds\n    const timestamp = Date.now();\n    // Generate a random string (8 characters)\n    const randomString = Math.random().toString(36).substring(2, 10);\n    // Combine components with Facebook's preferred prefix\n    const eventId = `fb_${timestamp}_${randomString}`;\n    return eventId;\n};\nexports.generateFbEventId = generateFbEventId;\n\n\n//# sourceURL=webpack:///./src/main/utils/index.ts?");

/***/ }),

/***/ "./src/main/utils/storage.ts":
/*!***********************************!*\
  !*** ./src/main/utils/storage.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nclass ExpiringSessionStorage {\n    constructor(defaultExpiry = 7 * 24 * 60 * 60 * 1000) {\n        this.cleanupInterval = 0;\n        // Default 7 days\n        this.defaultExpiry = defaultExpiry;\n    }\n    set(key, value, expiryMs = this.defaultExpiry) {\n        const item = {\n            value,\n            expiry: Date.now() + expiryMs,\n        };\n        try {\n            sessionStorage.setItem(key, JSON.stringify(item));\n            return true;\n        }\n        catch (e) {\n            console.error(\"SessionStorage set error:\", e);\n            return false;\n        }\n    }\n    get(key) {\n        try {\n            const itemStr = sessionStorage.getItem(key);\n            if (!itemStr)\n                return null;\n            const item = JSON.parse(itemStr);\n            if (Date.now() > item.expiry) {\n                this.delete(key);\n                return null;\n            }\n            return item.value;\n        }\n        catch (e) {\n            console.error(\"SessionStorage get error:\", e);\n            return null;\n        }\n    }\n    delete(key) {\n        try {\n            sessionStorage.removeItem(key);\n            return true;\n        }\n        catch (e) {\n            console.error(\"SessionStorage delete error:\", e);\n            return false;\n        }\n    }\n    /**\n     * Remove all expired items from storage\n     */\n    cleanup() {\n        try {\n            for (let i = 0; i < sessionStorage.length; i++) {\n                const key = sessionStorage.key(i);\n                if (key) {\n                    const itemStr = sessionStorage.getItem(key);\n                    if (itemStr) {\n                        const item = JSON.parse(itemStr);\n                        if (Date.now() > item.expiry) {\n                            this.delete(key);\n                            i--; // Adjust index since we removed an item\n                        }\n                    }\n                }\n            }\n        }\n        catch (e) {\n            console.error(\"SessionStorage cleanup error:\", e);\n        }\n    }\n    /**\n     * Clear all items from storage\n     */\n    clear() {\n        try {\n            sessionStorage.clear();\n        }\n        catch (e) {\n            console.error(\"SessionStorage clear error:\", e);\n        }\n    }\n}\nexports[\"default\"] = ExpiringSessionStorage;\n\n\n//# sourceURL=webpack:///./src/main/utils/storage.ts?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/main/index.ts");
/******/ 	
/******/ })()
;
